# 🧬 SCODE Gene Regulatory Network Inference Pipeline (Nextflow)

This project implements the **SCODE (Sparsity-promoting Contextual Orthogonal Decomposition)** algorithm for gene regulatory network (GRN) inference from single-cell RNA-seq data using a **Nextflow DSL2 pipeline**. It accepts `.h5ad` format input and outputs a ranked list of regulatory gene pairs.

The implementation follows the structure outlined in the [Beeline GRN Benchmarking Suite](https://github.com/Murali-group/Beeline) and uses R and Ruby for SCODE inference.

---

## 📁 Project Structure

```

SCODE\_Nextflow\_Complete/
├── main.nf                          # Main Nextflow pipeline
├── nextflow\.config                  # Configuration file
├── expression.txt                   # Expression matrix (autogenerated)
├── pseudotime.txt                   # Pseudotime vector (autogenerated)
├── results/                         # Output folder (auto-created)
├── modules/
│   └── grn/
│       └── scode/
│           ├── scode\_env.yml       # Conda environment (Python, R, etc.)
│           ├── h5ad\_to\_scode\_inputs.py  # Script to extract expression/pseudotime
│           ├── run\_R.rb            # Ruby wrapper to run SCODE
│           ├── SCODE.R             # R script for SCODE inference
│           └── averageA.R          # R script to average inferred networks
└── input/
└── filtered\_placeholder.h5ad   # Example input file

```

---

## 🔧 Setup Instructions

### 🧬 Prerequisites

Ensure you have the following installed:

- [Nextflow](https://www.nextflow.io/) ≥ 22.x
- [Miniconda/Conda](https://docs.conda.io/en/latest/)
- Python 3 with:
  - scanpy
  - anndata
  - pandas
  - numpy
- Ruby ≥ 2.5
- R ≥ 4.2 with:
  - optparse
  - R.utils

### ✅ Environment Setup

```bash
git clone https://github.com/YOUR_USERNAME/SCODE_Nextflow_Complete.git
cd SCODE_Nextflow_Complete

# Create Conda environment
conda env create -f modules/grn/scode/scode_env.yml -p ./scode_env

# Activate it
conda activate ./scode_env
```

---

## 🚀 Run the SCODE Pipeline

```bash
NXF_CONDA_CACHEDIR=./.conda nextflow run main.nf -with-conda -resume
```

**Result:** It will create a ranked edge list in:

```
results/ranked_edges.csv
```

---

## 📤 Output Format

The SCODE pipeline produces a **ranked list of gene-gene edges** in the format:

```
Source    Target    Rank    [Optional Weight/Score]
```

### 🧾 Example:

```
9889,100,88,0
9890,100,89,0
9891,100,90,0
...
```

_Note: Actual gene names are replaced with numerical indices. You may perform post-processing to map indices back to gene names._

---

## 📊 Post-processing Tips

You can visualize or validate results by plotting:

- Network edges
- Heatmaps of expression
- Ranking distributions of edges

Additionally, map the indices to gene names using the `var_names` field of your `.h5ad` input.

---

## 📚 Reference

- **Matsumoto et al. (2017)**
  _SCODE: An efficient regulatory network inference method from single-cell RNA-seq during differentiation_
  [Bioinformatics, Volume 33, Issue 15](https://doi.org/10.1093/bioinformatics/btx194)

- [Beeline GRN Benchmarking Suite](https://github.com/Murali-group/Beeline)

---

## 👨‍💻 Author

**Prosenjit Chowdhury**
M.Sc. Artificial Intelligence – FAU Erlangen-Nürnberg
Working Student @ SAP ERP PCX
Erlangen, Germany
🔗 GitHub: [@prosenjit-chowdhury](https://github.com/prosenjit-chowdhury)

---
